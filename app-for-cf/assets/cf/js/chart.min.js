let CloudflareAppChart={Chart:function(){this.__construct()}};
CloudflareAppChart.Chart.prototype={charts:[],__construct:function(){document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("#cfRange input").forEach(a=>{a.addEventListener("change",b=>{this.analytics(b)})});document.querySelector("#cfRange input").dispatchEvent(new Event("change"))},!1)},analytics:function(a){"object"==typeof XF?XF.ajax("POST",document.getElementById("cfRange").dataset.href,{range:a.target.value},this.generateCharts.bind(this)):fetch(ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},
body:new URLSearchParams({action:document.getElementById("cfRange").dataset.action,range:a.target.value})}).then(b=>b.json()).then(this.generateCharts.bind(this))},generateCharts:function(a){a=a.stats;document.querySelectorAll(".cfStats .displayData").forEach(b=>{let f=JSON.parse(b.dataset.label);b.querySelector("label div").innerHTML=this.formatNumber(a.totals[JSON.parse(b.dataset.data)[0]],parseInt(b.dataset.decimals),b.dataset.type);let e=[];JSON.parse(b.dataset.data).forEach((c,d)=>{let g=JSON.parse(b.dataset.color?
b.dataset.color:"[]");c={label:f[d],data:Object.values(a.detail[c])};g&&g[d]&&(c.backgroundColor=g[d]);e.push(c)});this.sparkChart(b.querySelector("canvas").getAttribute("id"),Object.keys(a.detail[JSON.parse(b.dataset.data)[0]]),e)})},sparkChart:function(a,b,f){let e=[];f.forEach((c,d)=>{e[d]={};Object.assign(e[d],{label:"",backgroundColor:"rgba(34,218,200,0.7)",cubicInterpolationMode:"monotone",fill:!0,data:[]},c)});"object"==typeof this.charts[a]?(this.charts[a].data={labels:b,datasets:e},this.charts[a].update()):
this.charts[a]=new Chart(a,{type:"line",data:{labels:b,datasets:e},options:{maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},scales:{x:{border:{width:0},ticks:{display:!1},grid:{display:!1}},y:{border:{width:0},ticks:{display:!1},grid:{display:!1},suggestedMin:0}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(c){let d=c.dataset.label||"";d&&(d+=": ");null!==c.parsed.y&&(d=a.includes("Bytes")?d+this.formatNumber(c.parsed.y,0,"bytes"):a.includes("Percent")?d+this.formatNumber(c.parsed.y,
2,"percent"):d+this.formatNumber(c.parsed.y,2,"num"));return d}.bind(this)}}}}})},formatNumber:function(a,b=0,f="bytes"){if(0==a)return"0";if("bytes"===f)var e=" B; KB; MB; GB; TB; PB; EB; ZB; YB".split(";");else"num"===f&&(e=["","k","M","B","T"]);let c=Math.max(0,Math.floor(Math.log(a)/Math.log(1E3)));return parseFloat((a/Math.pow(1E3,c)).toFixed(0>b?0:b))+("undefined"==typeof e?"":e[c])+("percent"===f?"%":"")}};CloudflareAppChart._Chart=new CloudflareAppChart.Chart;